1. Постановка задачи
С помощью библиотеки для графики нарисовать две трехмерные призмы, тень,
сделать закраску, подписать точки, а также реализовать методы работы с ней:
- перемещение;
- вращение;
- масштабирование;
- заливка видимых поверхностей.
Алгоритм закраски - Построчное заполнение
Алгоритм удаления невидимых линий и поверхностей - Алгоритм Варнока
Алгоритм построения тени - Построение «на землю» (источник света в
бесконечности)
2. Формализация задачи
При запуске программы создаётся окно размерами 1400 на 700 функцией
initwindow. Для создания и работы с точками используется класс Point, хранящий
координаты x, y и z точки её имя и метод для отображения её имени. Линии между
точками отрисовываются при помощи функции line_DDA алгоритмом рисования
DDA-линии. Класс Surface хранит имя поверхности (грани призмы), состояние её
видимости и цвет, которым она должна быть закрашена. В классе Prism содержатся
данные для призмы: восемь её точек, их имена, цвет линий. Конструктор класса задаёт
начальные координаты точек, их имена и отрисовывает треугольник на экране при
помощи метода класса drawPrism. Для задания цветов используются следующие
обозначения: TEXTCOL – цвет текста, MAINCOL – цвет границ треугольника и
WHITE – белый цвет. Перемещение осуществляется тремя методами: moveX, moveY и
moveZ, сдвигающим фигуру вертикально, горизонтально, на нас и от нас
соответственно. Методы rotateZ, rotateY и rotateX поворачивают фигуру по или против
часовой стрелки вокруг осей z, y и x соответственно. Метод scale масштабирует
фигуру. Метод colouring обеспечивает закраску видимых граней фигуры. Вызывая
методы seenL для проверки на видимость пересекающихся линий (определяется
методом cross) и seenS для определения видимости поверхностей, если никакие линии
не пересекаются. Метод fill заливает каждую поверхность, у которой поднят флаг
видимости. По завершении каждой из функций экран отчищается и выводится новая
отредактированная призма. Управление производится при помощи следующих клавиш
(без учёта раскладки и регистра):
W – перемещение вверх;
A – перемещение влево;
S – перемещение вниз;
D – перемещение вправо;
Z – перемещение вперёд;
X – перемещение назад;
Q, E – повороты против и по часовой стрелки вокруг оси z;
R, T – поворот против и по часовой стрелки вокруг оси y;
F, G – поворот против и по часовой стрелки вокруг оси x;
- – уменьшение в масштабе;
+ – увеличение в масштабе.
Нажатие любой другой клавиши приводит к завершению программы.
По завершении программы функция closegraph освобождает всю память,
выделенную под графическую систему, затем восстанавливает экран в режим, который
был до вызова initwindow.
class Point - класс для точек
class Surface - класс поверхностей
class Prism - класс фигуры
void drawPrism() - Рисование фигур
void scale(float e, Prism pri1, Prism pri2) - масштабирование фигуры
void colouring() - заливка граней
void shadow(Prism* shadow_pi1, Prism Pri2, Point light, int shadow_y) - установка
координат для тени
